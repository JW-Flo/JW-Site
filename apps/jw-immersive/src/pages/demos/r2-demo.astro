---
import BaseLayout from '../../layouts/BaseLayout.astro';
---

<BaseLayout title="R2 Storage Demo" description="Demonstration of Cloudflare R2 object storage">
  <div class="max-w-4xl mx-auto">
    <div class="text-center mb-12">
      <h1 class="text-4xl md:text-5xl font-bold mb-6 bg-gradient-to-r from-blue-400 via-purple-500 to-blue-600 bg-clip-text text-transparent">
        R2 Storage Demo
      </h1>
      <p class="text-xl text-slate-300 mb-4">
        View objects stored in Cloudflare R2 bucket
      </p>
    </div>

    <div class="bg-slate-800/50 backdrop-blur-sm border border-slate-600 rounded-xl p-8">
      <h2 class="text-2xl font-bold text-blue-400 mb-6">R2 Bucket Contents</h2>
      <p class="text-slate-300 mb-6">Listing first 20 objects from the R2 bucket.</p>
      
      <div id="r2-output" class="bg-slate-700/30 rounded-lg p-6 border border-slate-600/50">
        <div class="text-center text-slate-400 py-8">
          Loading R2 bucket contents...
        </div>
      </div>
    </div>
  </div>
</BaseLayout>

<script>
  (async () => {
    try {
      const response = await fetch('/api/r2/list');
      const data = await response.json();
      document.getElementById('r2-output').innerHTML = `
        <pre class="text-sm bg-slate-900/50 p-4 rounded overflow-auto text-purple-300">${JSON.stringify(data, null, 2)}</pre>
      `;
    } catch (error) {
      document.getElementById('r2-output').innerHTML = `
        <div class="text-center text-red-400 py-4">
          Error loading R2 data. Please check the console for details.
        </div>
      `;
      console.error('R2 demo error:', error);
    }
  })();
</script>
