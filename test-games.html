<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Game Architecture Test</title>
  <style>
    body {
      margin: 0;
      padding: 20px;
      font-family: monospace;
      background: #000011;
      color: #00ff00;
    }
    canvas {
      border: 2px solid #00ff00;
      background: #000011;
      display: block;
      margin: 20px auto;
    }
    .controls {
      text-align: center;
      margin: 20px 0;
    }
    button {
      background: #00ff00;
      color: #000011;
      border: none;
      padding: 10px 20px;
      margin: 0 10px;
      cursor: pointer;
      font-family: monospace;
      font-weight: bold;
    }
    button:hover {
      background: #00ffff;
    }
  </style>
</head>
<body>
  <h1>🎮 Modular Game Architecture Test</h1>
  <p>Testing the new modular game system with lazy loading and clean separation of concerns.</p>
  
  <div class="controls">
    <button id="test-menu">Test Menu Game</button>
    <button id="test-space-invaders">Test Space Invaders</button>
    <button id="test-asteroids">Test Asteroids</button>
    <button id="stop-game">Stop Game</button>
  </div>
  
  <canvas id="test-canvas" width="800" height="600"></canvas>
  
  <div id="status">Ready to test games...</div>

  <script type="module">
    import { GameManager } from './src/utils/GameManager.js';
    
    class GameTester {
      constructor() {
        this.canvas = document.getElementById('test-canvas');
        this.status = document.getElementById('status');
        this.gameManager = null;
        this.currentGame = null;
        
        this.bindEvents();
        this.log('Game Tester initialized');
      }
      
      bindEvents() {
        document.getElementById('test-menu').addEventListener('click', () => this.testMenu());
        document.getElementById('test-space-invaders').addEventListener('click', () => this.testSpaceInvaders());
        document.getElementById('test-asteroids').addEventListener('click', () => this.testAsteroids());
        document.getElementById('stop-game').addEventListener('click', () => this.stopGame());
      }
      
      async testMenu() {
        this.log('Testing Menu Game...');
        try {
          if (this.gameManager) {
            await this.gameManager.deactivate();
          }
          
          this.gameManager = new GameManager({
            canvas: this.canvas,
            showLeaderboard: () => this.log('Leaderboard shown'),
            hideLeaderboard: () => this.log('Leaderboard hidden'),
            updateLeaderboard: (data) => this.log('Leaderboard updated:', data.length, 'entries'),
            showInstructions: (controls) => this.log('Instructions shown:', controls),
            hideInstructions: () => this.log('Instructions hidden')
          });
          
          await this.gameManager.activate();
          this.log('✅ Menu Game loaded successfully!');
        } catch (error) {
          this.log('❌ Menu Game failed:', error.message);
        }
      }
      
      async testSpaceInvaders() {
        this.log('Testing Space Invaders...');
        try {
          if (this.gameManager) {
            await this.gameManager.deactivate();
          }
          
          this.gameManager = new GameManager({
            canvas: this.canvas,
            showLeaderboard: () => this.log('Leaderboard shown'),
            hideLeaderboard: () => this.log('Leaderboard hidden'),
            updateLeaderboard: (data) => this.log('Leaderboard updated:', data.length, 'entries'),
            showInstructions: (controls) => this.log('Instructions shown:', controls),
            hideInstructions: () => this.log('Instructions hidden')
          });
          
          await this.gameManager.activate();
          await this.gameManager.startGame('Space Invaders');
          this.log('✅ Space Invaders loaded successfully!');
        } catch (error) {
          this.log('❌ Space Invaders failed:', error.message);
        }
      }
      
      async testAsteroids() {
        this.log('Testing Asteroids...');
        try {
          if (this.gameManager) {
            await this.gameManager.deactivate();
          }
          
          this.gameManager = new GameManager({
            canvas: this.canvas,
            showLeaderboard: () => this.log('Leaderboard shown'),
            hideLeaderboard: () => this.log('Leaderboard hidden'),
            updateLeaderboard: (data) => this.log('Leaderboard updated:', data.length, 'entries'),
            showInstructions: (controls) => this.log('Instructions shown:', controls),
            hideInstructions: () => this.log('Instructions hidden')
          });
          
          await this.gameManager.activate();
          await this.gameManager.startGame('Asteroids');
          this.log('✅ Asteroids loaded successfully!');
        } catch (error) {
          this.log('❌ Asteroids failed:', error.message);
        }
      }
      
      async stopGame() {
        if (this.gameManager) {
          await this.gameManager.deactivate();
          this.gameManager = null;
          this.log('Game stopped');
        }
      }
      
      log(message, ...args) {
        const timestamp = new Date().toLocaleTimeString();
        this.status.textContent = `[${timestamp}] ${message}`;
        console.log(`[${timestamp}]`, message, ...args);
      }
    }
    
    // Initialize tester when page loads
    document.addEventListener('DOMContentLoaded', () => {
      new GameTester();
    });
  </script>
</body>
</html>
